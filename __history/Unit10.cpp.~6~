//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit10.h"
#include "Unit9.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm10 *Form10;
//---------------------------------------------------------------------------
__fastcall TForm10::TForm10(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm10::Button2Click(TObject *Sender)
{
    Form10->Close();
}
//---------------------------------------------------------------------------
void __fastcall TForm10::Button1Click(TObject *Sender)
{
	String CheckIsp;

	if(ADD_OR_EDIT->Caption == "ADD")
	{


        if(CheckBox1->Checked == true)
		{
			CheckIsp = 1;
		}
		else
		{
			CheckIsp = 0;

		}



			Form9->ADOQuery1->SQL->Text = "INSERT INTO obr VALUES (dmax('vindex', 'obr')+1, "+number->Text+",'"+date->Date+"','"+FIO->Text+"','"+ADRES->Text+"','net','rez','null','No_File','"+Memo1->Text+"','"+TEMA->Text+"','"+CheckIsp+"') ";
			Form9->ADOQuery1->ExecSQL();


			Form9->ADOQuery1->Active = false;
			Form9->ADOQuery1->SQL->Text = "SELECT * FROM obr ORDER BY number";
			Form9->ADOQuery1->Active = true;


		Form10->Close();
	}
}
//---------------------------------------------------------------------------

